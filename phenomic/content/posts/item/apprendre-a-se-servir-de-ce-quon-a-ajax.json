{"filename":"index.md","title":"Apprendre à se servir de ce qu'on a : AJAX","headings":[{"level":2,"text":"AJAX, ou plutôt XMLHttpRequest","id":"ajax-ou-plutôt-xmlhttprequest"},{"level":2,"text":"Faire pareil, mais sans","id":"faire-pareil-mais-sans"},{"level":3,"text":"Envoyer une requête simple, sans paramètre","id":"envoyer-une-requête-simple-sans-paramètre"},{"level":3,"text":"Envoyer une requête avec des paramètres","id":"envoyer-une-requête-avec-des-paramètres"},{"level":3,"text":"Récupérer la réponse","id":"récupérer-la-réponse"},{"level":3,"text":"Récupérer les données reçues","id":"récupérer-les-données-reçues"},{"level":3,"text":"Gérer les erreurs","id":"gérer-les-erreurs"},{"level":3,"text":"Récapitulons","id":"récapitulons"},{"level":2,"text":"XMLHttpRequest 2, le retour","id":"xmlhttprequest-2-le-retour"},{"level":2,"text":"Le \"futur\" des requêtes asynchrones","id":"le-futur-des-requêtes-asynchrones"},{"level":2,"text":"Pour finir","id":"pour-finir"}],"date":"2016-11-03","timeSensitive":true,"body":{"t":"div","c":[{"t":"p","c":["Quel site web, aujourd'hui, n'utilise pas de requête AJAX, cette technologie\npermettant d'envoyer des requêtes HTTP à un serveur de manière (a)synchrone, et\ndonc de rafraîchir des données affichées sans avoir à recharger la page en\ncours de consultation ? Celui que vous êtes en train de lire, certes... Mais\naujourd'hui une grande majorité des sites web que vous visitez tirent très\ncertainement parti d'AJAX. Mais au fait, quand on fait un ",{"t":"code","c":["$.ajax()"]},", ça fait\nquoi ?"]},"\n",{"t":"p","c":[{"t":"span","p":{"class":"more"}}]},"\n",{"t":"p","c":[{"t":"em","c":["Cet article est le sixième de la série ",{"t":"a","p":{"href":"/articles/apprendre-a-se-servir-de-ce-quon-a"},"c":["\"apprendre à se servir de ce qu'on\na\""]},", ayant pour objectif de\nmontrer que l'utilisation d'une bibliothèque telle que jQuery n'a pas toujours\nde sens. N'hésitez pas à parcourir les autres articles !"]}]},"\n",{"t":"h2","p":{"id":"ajax-ou-plutôt-xmlhttprequest"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#ajax-ou-plutôt-xmlhttprequest"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"AJAX, ou plutôt XMLHttpRequest"]},"\n",{"t":"p","c":["AJAX (pour Asynchronous Javascript And XML) n'est pas une technologie en tant\nque telle, mais un ensemble de technologies. Ce concept se base en particulier\nsur l'objet ",{"t":"code","c":["XMLHttpRequest"]}," introduit par Microsoft dans Internet Explorer,\nqui a été par la suite standardisé."]},"\n",{"t":"p","c":[{"t":"code","c":["XMLHttpRequest"]}," permet d'envoyer des requêtes HTTP vers un serveur sans avoir\nà rafraichir la page en cours d'affichage. Ces requêtes peuvent être synchrones\nou asynchrones. Dans le premier cas, l'exécution du thread JS est interrompue\net attend la réponse du serveur pour reprendre. Dans le second cas, le thread\ncontinue sa petite vie, et c'est un événement qui sera lancé pour le notifiier\nde l'arrivée de la réponse du serveur. Il va sans dire que c'est le deuxième\ncas qui est le plus intéressant, puisque le premier bloque tout interaction\navec la page tant que la réponse n'est pas arrivée."]},"\n",{"t":"p","c":["Le nom \"AJAX\" est trompeur car le serveur ne renvoie pas obligatoirement du\nXML. Plusieurs formats peuvent être gérés : texte brut, HTML, XML, JSON,\ndonnées binaires..."]},"\n",{"t":"h2","p":{"id":"faire-pareil-mais-sans"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#faire-pareil-mais-sans"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Faire pareil, mais sans"]},"\n",{"t":"p","c":["Voyons voir comment fonctionne cet objet XMLHttpRequest."]},"\n",{"t":"h3","p":{"id":"envoyer-une-requête-simple-sans-paramètre"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#envoyer-une-requête-simple-sans-paramètre"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Envoyer une requête simple, sans paramètre"]},"\n",{"t":"p","c":["D'abord il nous faut un objet..."]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var xhr = new XMLHttpRequest();"]}]}]}]},"\n",{"t":"p","c":["Ensuite il faut dire sur quelle URL on veut faire notre requête et la méthode\nHTTP qu'on veut utiliser. Il est possible d'utiliser les méthodes GET et POST,\nainsi qu'une plus spéciale, HEAD, qui permet de ne récupérer que l'entête de la\nréponse. Pour commencer, nous allons faire une simple requête en GET sur la\npage d'accueil du blog :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.open(\"GET\", \""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\");"]}]}]}]},"\n",{"t":"p","c":["Il est possible de spécifier 3 autres paramètres :"]},"\n",{"t":"ul","c":["\n",{"t":"li","c":["Un booléen spécifiant si la requête est asynchrone ou non. Par défaut\ncelui-ci vaut ",{"t":"code","c":["true"]},", donc la requête sera asynchrone"]},"\n",{"t":"li","c":["Un login en cas d'identification nécessaire (type .htaccess)"]},"\n",{"t":"li","c":["Le mot de passe qui va avec"]},"\n"]},"\n",{"t":"p","c":["Pour faire une requête HEAD ou POST, il suffit de spécifier la méthode\nsouhaitée en premier paramètre."]},"\n",{"t":"p","c":["Il ne nous reste plus qu'à envoyer la requête :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.send(null);"]}]}]}]},"\n",{"t":"h3","p":{"id":"envoyer-une-requête-avec-des-paramètres"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#envoyer-une-requête-avec-des-paramètres"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Envoyer une requête avec des paramètres"]},"\n",{"t":"p","c":["Dans le cas d'une requête GET ou HEAD (qui n'est ni plus ni moins qu'une\nrequête GET, à la différence près qu'on ne récupère que l'entête de la\nréponse), le passage de paramètres se fait dans l'URL qu'on passe à la méthode\n",{"t":"code","c":["open"]},", comme on le ferait dans la barre d'adresse de notre navigateur :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.open(\"GET\", \""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr?param1=value2&param2=value2"]}]},{"t":"span","c":["\");"]}]}]}]},"\n",{"t":"p","c":["Dans le cas d'une requête POST, il faut d'abord préciser dans l'entête de la\nrequête que les paramètres viennent d'un formulaire (même si ce n'est pas le\ncas) :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.open(\"POST\", \""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.setRequestHeader(\"Content-Type\", \"application/x-form-urlencoded\");"]}]}]}]},"\n",{"t":"p","c":["Puis il faut passer les paramètres à la méthode ",{"t":"code","c":["send"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.send(\"param1=value1&param2=value2\");"]}]}]}]},"\n",{"t":"p","c":["Dans les deux cas, il est nécessaire de convertir les paramètres qu'on veut\npasser à notre requête, afin que ceux-ci ne contiennent aucun caractère\ninterdit dans une URL. Pour cela, il faut utiliser la fonction\n",{"t":"code","c":["encodeURIComponent"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// le caractère \"&\" a une signification dans une URL, il faut donc le convertir"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var param1 = encodeURIComponent(\"value1&\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// ici, pas de caractère à convertir, mais dans le cas d'une saisie utilisateur, on ne peut pas prédire ce qu'on reçoit !"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var param2 = encodeURIComponent(\"value2\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.send(\"param1=\" + param1 + \"&param2=\" + param2);"]}]}]}]},"\n",{"t":"p","c":["Maintenant qu'on sait envoyer une requête, il faudrait savoir..."]},"\n",{"t":"h3","p":{"id":"récupérer-la-réponse"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#récupérer-la-réponse"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Récupérer la réponse"]},"\n",{"t":"p","c":["Qui dit asynchrone dit callback. On va donc commencer par attacher une fonction\nà un événement qui nous notifiera l'arrivée de la réponse :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// Directement via onreadystatechange"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {};"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// Ou avec addEventListener"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.addEventListener(\"readystatechange\", function() {});"]}]}]}]},"\n",{"t":"p","c":["Comme le nom de l'événement l'indique, nous n'écoutons pas réellement l'arrivée\nde la réponse, mais tout changement d'état de la requête. Le nombre d'état\npossible pour une ",{"t":"code","c":["XMLHttpRequest"]}," est de 5. Chaque état est représenté par un\nnombre entier, ainsi qu'une constante de l'objet ",{"t":"code","c":["XMLHttpRequest"]}," qui le\nreprésente :"]},"\n",{"t":"ul","c":["\n",{"t":"li","c":[{"t":"code","c":["XMLHttpRequest.UNSENT === 0"]}," : on a un objet ",{"t":"code","c":["XMLHttpRequest"]}," tout frais sur\nlequel la méthode ",{"t":"code","c":["open()"]}," n'a pas encore été appelée"]},"\n",{"t":"li","c":[{"t":"code","c":["XMLHttpRequest.OPENED === 1"]}," : la méthode ",{"t":"code","c":["open()"]}," a été appelée sur\nl'objet, mais pas la méthode ",{"t":"code","c":["send()"]}]},"\n",{"t":"li","c":[{"t":"code","c":["XMLHttpRequest.HEADERS_RECEIVED === 2"]}," : la méthode ",{"t":"code","c":["send()"]}," a été appelée,\nla requête a été entièrement envoyée"]},"\n",{"t":"li","c":[{"t":"code","c":["XMLHttpRequest.LOADING === 3"]}," : le serveur a commencé à renvoyer des données"]},"\n",{"t":"li","c":[{"t":"code","c":["XMLHttpRequest.DONE === 4"]}," : on a reçu toutes les données de la réponse"]},"\n"]},"\n",{"t":"p","c":["Puisqu'on est intéressés uniquement par le dernier état, on va commencer par\najouter une condition sur celui-ci :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["Il faut maintenant détecter si tout s'est bien passé. Si c'est le cas, alors la\nréponse du serveur doit avoir un code HTTP 2xx. Nouvelle condition :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    if (xhr.status >= 200 && xhr.status < 300) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // OK"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    } else {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // Erreur ou redirection HTTP. Il est possible de gérer ces cas,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // mais le but est de rester le plus simple possible ici"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"h3","p":{"id":"récupérer-les-données-reçues"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#récupérer-les-données-reçues"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Récupérer les données reçues"]},"\n",{"t":"p","c":["Les données de la réponse sont contenues dans ",{"t":"code","c":["xhr.responseXML"]}," si ces données\nsont du XML, et dans ",{"t":"code","c":["xhr.responseText"]}," dans tous les autres cas. ",{"t":"code","c":["responseXML"]},"\nest un DOM qui peut être parcouru de la même manière que n'importe quel autre\nDOM. ",{"t":"code","c":["responseText"]}," n'est que du texte brut. Si on sait qu'on reçoit du JSON,\nalors on peut le parser avec ",{"t":"code","c":["JSON.parse()"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    if (xhr.status >= 200 && xhr.status < 300) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // On récupère du XML"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      var elements = xhr.responseXML.getElementsByTagName(\"element\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // On récupère du JSON"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      var data = JSON.parse(xhr.responseText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    } else {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      // Erreur"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"h3","p":{"id":"gérer-les-erreurs"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#gérer-les-erreurs"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Gérer les erreurs"]},"\n",{"t":"p","c":["Lorsque le status n'est pas 2xx, c'est que le serveur a renvoyé une erreur.\nDans ce cas, on peut savoir quelle est l'erreur en regardant le code HTTP\ncontenu dans ",{"t":"code","c":["xhr.status"]},", évidemment, mais aussi ce que contient\n",{"t":"code","c":["xhr.statusText"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    if (xhr.status >= 200 && xhr.status < 300) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      var data = JSON.parse(xhr.responseText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    } else {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      console.error(xhr.status, xhr.statusText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"h3","p":{"id":"récapitulons"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#récapitulons"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Récapitulons"]},"\n",{"t":"p","c":["Pour faire de l'AJAX sans jQuery, voici donc ce qu'il faut faire (on imagine\nqu'on veut faire une requête en POST avec les paramètres ",{"t":"code","c":["param1"]}," et ",{"t":"code","c":["param2"]},"\nsur ",{"t":"code","c":["http://jesmodrazik.fr"]},", et qu'on récupère du JSON qu'on veut simplement\nafficher dans la console du navigateur):"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var xhr = new XMLHttpRequest();"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var param1 = encodeURIComponent(\"value1&\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var param2 = encodeURIComponent(\"value2\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.open(\"POST\", \""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.setRequestHeader(\"Content-Type\", \"application/x-form-urlencoded\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    if (xhr.status >= 200 && xhr.status < 300) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      var data = JSON.parse(xhr.responseText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      console.log(data);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    } else {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      console.error(xhr.status, xhr.statusText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.send(\"param1=\" + param1 + \"&param2=\" + param2);"]}]}]}]},"\n",{"t":"p","c":["Bon heu... Autant d'habitude le JS natif est aussi simple, ou tout du moins pas\nbeaucoup plus compliqué que l'équivalent avec jQuery, autant là, je dois avouer\nque jQuery a gagné :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["$.ajax({"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  type: \"POST\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  url: \"hhtp://jesmodrazik.fr\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  data: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    param1: \"value1&\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    param2: \"value2\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  success: function(data) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    console.log(data);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  dataType: \"json\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["});"]}]}]}]},"\n",{"t":"p","c":["Mais on va pas se laisser abattre, on peut toujours se débrouiller sans lui !"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["function ajax(options) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  options.async = options.hasOwnProperty(\"async\") ? options.async : true;"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  options.headers = options.headers ? options.headers : {};"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  var xhr = new XMLHttpRequest();"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  xhr.open(options.type, options.url, options.async);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  Object.keys(options.headers).forEach(function(header) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    xhr.setRequestHeader(header, options.headers[header]);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  });"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  xhr.onreadystatechange = function() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    if (xhr.readyState === xhr.DONE) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      if (xhr.status >= 200 && xhr.status < 300) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options.success(xhr.responseXML || xhr.responseText, xhr.status);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      } else {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options.error(xhr.status, xhr.statusText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  };"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  xhr.send(options.data || null);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  return xhr;"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["ajax({"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  type: \"POST\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  url: \""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  data:"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    \"param1=\" +"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    encodeURIComponent(\"value1&\") +"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    \"&param2=\" +"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    encodeURIComponent(\"value2\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  success: function(data, status) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    var json = JSON.parse(data);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    console.log(data, status);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  error: function(status, statusText) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    console.error(status, statusText);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["});"]}]}]}]},"\n",{"t":"p","c":["Et voilà ! Cette fonction pourrait être plus poussée, mais en l'état elle\ncouvre la grande majorité des cas d'utilisation."]},"\n",{"t":"h2","p":{"id":"xmlhttprequest-2-le-retour"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#xmlhttprequest-2-le-retour"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"XMLHttpRequest 2, le retour"]},"\n",{"t":"p","c":["La deuxième version de la spécification XMLHttpRequest apporte son lot d'ajouts\nintéressants :"]},"\n",{"t":"ul","c":["\n",{"t":"li","c":["la possibilité de spécifier un format de réponse, via ",{"t":"code","c":["xhr.responseType"]},", et\nde récupérer la réponse directement au bon format via ",{"t":"code","c":["xhr.response"]},". Les\nformats possibles sont ",{"t":"code","c":["text"]},", ",{"t":"code","c":["arraybuffer"]},", ",{"t":"code","c":["blob"]},", ",{"t":"code","c":["document"]}," ou ",{"t":"code","c":["json"]}]},"\n",{"t":"li","c":["la possibilité d'envoyer tous les formats précédents à la requête"]},"\n",{"t":"li","c":["l'objet ",{"t":"code","c":["FormData"]}," pour envoyer très simplement des données de formulaire (et\nqui gère aussi l'upload !) :"]},"\n"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var form = document.querySelector(\"#myForm\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["var data = new FormData(form);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["xhr.send(data);"]}]}]}]},"\n",{"t":"p","c":["Avec ces évolutions, l'objet ",{"t":"code","c":["XMLHttpRequest"]}," n'est pas refondu en profondeur,\nmais se voit ajouter quelques propriétés qui ouvrent de nouvelles possibilités."]},"\n",{"t":"h2","p":{"id":"le-futur-des-requêtes-asynchrones"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#le-futur-des-requêtes-asynchrones"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Le \"futur\" des requêtes asynchrones"]},"\n",{"t":"p","c":["Avec l'arrivée d'ES2015, des nouveautés concernant les traitements asynchrones\net les requêtes AJAX sont arrivées."]},"\n",{"t":"p","c":["D'abord, l'API\n",{"t":"a","p":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch"},"c":[{"t":"code","c":["fetch"]}]},",\nbasée sur les ",{"t":"code","c":["Promise"]},"s, qui permet de faire une requête GET asynchrone en une\nligne, et d'en traiter le résultat avec du code très lisible :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["fetch(\""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\")"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  .then(function(response) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    return response.json();"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  })"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  .then(function(data) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    console.log(data);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  });"]}]}]}]},"\n",{"t":"p","c":["Je vous invite à aller sur le\n",{"t":"a","p":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch"},"c":["MDN"]},"\nsi vous voulez en savoir plus."]},"\n",{"t":"p","c":["Enfin, l'arrivée des fonctions asynchrones va permettre d'écrire du code\nasynchrone comme si celui-ci était synchrone :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["function getSomething() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  return fetch(\""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik.fr"]}]},{"t":"span","c":["\").then(function(response) {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    return response.json();"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  });"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["async function getSomething() {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  const data = await fetch(\""]},{"t":"span","p":{"class":"syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink"},"c":[{"t":"span","c":["http://jesmodrazik"]}]},{"t":"span","c":["\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  console.log(data);"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]}]},"\n",{"t":"p","c":["Ici, la fonction est déclarée comme étant asynchrone grâce au mot-clef ",{"t":"code","c":["async"]},",\nce qui donne accès au mot-clef ",{"t":"code","c":["await"]}," à l'intérieur de la fonction. Ce\nmot-clef permet de mettre en pause la fonction le temps qu'une ",{"t":"code","c":["Promise"]}," soit\nrésolue ou rejettée. Pour en savoir plus à propos des fonctions asynchrones, je\nvous conseilles la lecture de ",{"t":"a","p":{"href":"http://putaindecode.io/fr/articles/js/es2016/async-await/"},"c":["cet\narticle"]},"."]},"\n",{"t":"h2","p":{"id":"pour-finir"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#pour-finir"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Pour finir"]},"\n",{"t":"p","c":["Ca commence à devenir répétitif, mais la conclusion reste évidemment toujours a\nmême : comme pour la manipulation du DOM, du style des éléments de ce même DOM,\ndes animations, de la délégation d'événements, et j'en passe, il est donc\npossible, pour les cas les plus courants, de se passer de jQuery pour faire des\nrequêtes AJAX. L'important est de se poser la bonne question : est-ce que pour\nfaire ce dont j'ai besoin, jQuery est nécessaire ? Il est aussi important, même\nsi on s'est mit au JavaScript avec jQuery, d'apprendre les fondamentaux. La\nconnaissance du langage est plus valorisante que celle de n'importe quelle\nlibrairie. En effet, connaître le langage permet de s'adapter simplement à\nn'importe quelle librairie. Alors que l'inverse n'est pas vrai."]}]}}