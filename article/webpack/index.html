<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/phenomic/phenomic.main.29349b76.css"/></head><body><div id="PhenomicRoot"><div data-reactroot=""><header class="header"><div class="content-wrap"><div class="logo"><h1><a href="/">Jesmo Drazik Blog</a></h1><p class="description">Développeur front-end @ Cozy Cloud</p><div class="find-me"><a href="https://twitter.com/JesmoDrazik">Twitter</a><a href="https://github.com/drazik">GitHub</a></div></div></div></header><div id="content"><div class="content-wrap"><div><article class="article"><h1 style="text-align:center">webpack</h1><div><h2 id="quest-ce-que-webpack-"><a aria-hidden="true" href="#quest-ce-que-webpack-"><span class="icon icon-link"></span></a>Qu&#x27;est-ce que webpack ?</h2>
<p><a href="https://webpack.js.org/">webpack</a> est un <em>module bundler</em>. Il construit le
graphe de dépendances d&#x27;une application JS afin de les regrouper dans un ou
plusieurs <em>bundle(s)</em> qui pourront être exécutés dans un navigateur web. Il
nous permet donc d&#x27;écrire du code modulaire, bien que les navigateurs
n&#x27;implémentent pour la plupart pas encore les modules ES2015. Il fait donc la
même chose que <a href="http://browserify.org/">browserify</a>. Toutefois, webpack est
très différent de browserify, de par sa philosophie bien particulière.</p>
<h2 id="ici-tout-est-module"><a aria-hidden="true" href="#ici-tout-est-module"><span class="icon icon-link"></span></a>Ici, tout est module</h2>
<p>La philosophie de webpack est de traiter n&#x27;importe quelle dépendance d&#x27;une
application comme un module. Ainsi, un fichier JS est un module, un fichier CSS
est un module, une image est un module... Tous ces modules sont consommables
directement dans le code JS.</p>
<p>On peut donc faire les choses suivantes avec webpack :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// Importer un module JS, classique</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import add from &quot;./add.js&quot;;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// Importer un fichier CSS</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import styles from &quot;./styles.css&quot;;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// Importer une image</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import logo from &quot;./logo.png&quot;;</span></span></div></pre>
<p>Webpack est capable de gérer à peu près n&#x27;importe quel type de fichier, grâce à
son systême de <em>loaders</em>. À un type de fichier correspond un (ou plusieurs)
<em>loader(s)</em>, qui a pour but de dire à webpack comment faire pour charger ce
type de fichier.</p>
<h2 id="installer-webpack"><a aria-hidden="true" href="#installer-webpack"><span class="icon icon-link"></span></a>Installer webpack</h2>
<p>Rien de plus simple, ça se fait évidemment via <code>npm</code> :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev webpack</span></span></div></pre>
<p>Une fois installé, le binaire de webpack est disponible dans
<code>./node_modules/.bin/webpack</code>. Pour éviter d&#x27;avoir à taper le chemin complet à
chaque fois, on peut écrire un script npm dans notre <code>package.json</code> :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&quot;scripts&quot;: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  &quot;build&quot;: &quot;webpack&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>}</span></span></div></pre>
<p>De cette manière, il suffira de taper <code>npm run build</code>, plutôt que
<code>./node_modules/.bin/webpack</code> pour lancer webpack.</p>
<p><em>Il est aussi possible d&#x27;<a href="https://webpack.js.org/guides/installation/#global-installation">installer webpack en
global</a>, mais
ce n&#x27;est pas conseillé.</em></p>
<p><em>Si vous voulez en savoir plus à propos des scripts npm, vous pouvez aller voir
l&#x27;article <a href="/articles/ne-plus-installer-gulp-en-dependance-globale/">&quot;ne plus installer gulp en dépendance
globale&quot;</a>, qui traite
de ce sujet.</em></p>
<h2 id="configurer-webpack"><a aria-hidden="true" href="#configurer-webpack"><span class="icon icon-link"></span></a>Configurer webpack</h2>
<p>Pour faire fonctionner webpack, on va créer un fichier de configuration, nommé
<code>webpack.config.js</code>. Le minimum requis est un point d&#x27;entrée et un point de
sortie :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  // Notre fichier source</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    // le chemin vers le bundle que webpack va générer</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    // le nom du bundle</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>Avec cette configuration minimale, webpack est capable de gérer nos dépendances
JS. Donc, si on a la configuration suivante :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// assets/js/add.js</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>export default const add = (a, b) =&gt; a + b;</span></span></div></pre>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// assets/js/app.js</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import add from &quot;./add.js&quot;;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>console.log(add(1, 2));</span></span></div></pre>
<p>webpack générera un seul fichier, regroupant <code>add.js</code> et <code>app.js</code>, et qui une
fois importé dans une page web, affichera <code>3</code> dans la console.</p>
<p><em>Note : webpack supporte par défaut la syntaxe des modules ES2015. Toutefois,
c&#x27;est le seul aspect de cette syntaxe qu&#x27;il transpile directement. Pour le
reste, il faut utiliser babel.</em></p>
<h2 id="les-loaders"><a aria-hidden="true" href="#les-loaders"><span class="icon icon-link"></span></a>Les loaders</h2>
<p>webpack met à disposition une API permettant de lui dire ce qu&#x27;il doit faire
lorsqu&#x27;il charge un module : les <em>loaders</em>.</p>
<p>Par exemple, il est possible de lui dire &quot;tiens, webpack, lorsque tu charges un
fichier JS, alors passe le dans babel pour récupérer le code transpilé avant de
créer ton bundle&quot;. Pour ça, il faut d&#x27;abord installer
<a href="https://www.npmjs.com/package/babel-loader"><code>babel-loader</code></a> et
<a href="https://www.npmjs.com/package/babel-core"><code>babel-core</code></a>. De plus, nous allons
aussi utiliser le preset
<a href="https://www.npmjs.com/package/babel-preset-env"><code>env</code></a>.</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev babel-loader babel-core babel-preset-env</span></span></div></pre>
<p>Il faut ensuite modifier notre configuration, pour y ajouter le loader et le
configurer :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  module: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    rules: [</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // le test se fait sur le nom des fichiers qu&#x27;on importe</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // ici, on veut que cette règle s&#x27;applique à tous les fichiers dont</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // le nom se termine par &quot;.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.js$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // on demande à webpack de n&#x27;appliquer cette règle qu&#x27;aux fichiers qui</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // se trouvent dans ./assets/js. Sinon, il l&#x27;appliquerait à tous les</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // fichiers JS, mêmes ceux de node_modules par exemple</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        include: path.join(__dirname, &quot;assets&quot;, &quot;js&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // si le test passe, alors on veut appliquer le babel-loader</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;babel-loader&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // on passe des options au loader. Ici, on veut utiliser le preset &quot;env&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        options: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>          presets: [&quot;env&quot;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    ]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>Lorsqu&#x27;il tombera sur un nouveau module à importer, webpack le confrontera à
toutes les règles que nous avons définies, et celles pour lesquelles le test
est satisfait lui seront appliquées.</p>
<h2 id="importer-autre-chose-que-du-js"><a aria-hidden="true" href="#importer-autre-chose-que-du-js"><span class="icon icon-link"></span></a>Importer autre chose que du JS</h2>
<p>Le graphe de dépendance créé par webpack permet de n&#x27;ajouter au bundle que les
modules effectivements importés dans notre application. Utiliser ce mécanisme
pour d&#x27;autres types de ressources serait très intéressant. Et justement, le
système de loaders va nous permettre d&#x27;importer n&#x27;importe quel autre type de
fichier directement dans notre JS, et de le consommer comme étant un module de
notre application.</p>
<p>Prenons le cas d&#x27;un fichier CSS simple. Nous avons un fichier
<code>assets/css/app.css</code> contenant l&#x27;ensemble du style de notre site. Nous voulons
que webpack ajoute celui-ci à son graphe de dépendances afin qu&#x27;il fasse partie
de notre bundle final. On l&#x27;importe donc dans notre fichier <code>app.js</code> :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// assets/js/app.js</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import styles from &quot;../css/app.css&quot;;</span></span></div></pre>
<p>Puis on demande à webpack de créer notre bundle avec <code>npm run build</code>. Et on se
prend l&#x27;erreur suivante :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ERROR in ./assets/css/app.css</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Module parse failed: C:\Users\ASUS\workspace\article-webpack\assets\css\app.css Unexpected token (1:5)</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>You may need an appropriate loader to handle this file type.</span></span></div></pre>
<p>Ce que nous explique webpack, c&#x27;est qu&#x27;il aimerait bien importer notre fichier,
mais il ne sait pas comment faire. En effet, webpack ne sait s&#x27;occuper que des
fichiers JS out of the box. On va donc se servir d&#x27;un loader, non pas pour
transformer ce qui est importé, mais pour expliquer à webpack ce qu&#x27;il doit
faire quand on lui demande de charger un fichier CSS. Ce loader, c&#x27;est le
<a href="https://www.npmjs.com/package/css-loader"><code>css-loader</code></a>.</p>
<p>On commence par l&#x27;installer :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev css-loader</span></span></div></pre>
<p>Puis on l&#x27;ajoute aux règles de notre configuration :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  module: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    rules: [</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.js$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;babel-loader&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        include: path.join(__dirname, &quot;assets&quot;, &quot;js&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        options: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>          presets: [&quot;env&quot;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // pour les fichiers CSS...</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.css$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // ...utilise le css-loader</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;css-loader&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    ]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>De cette manière, webpack sera capable d&#x27;importer un fichier CSS. Toutefois, si
on recharge notre page, on s&#x27;apperçoit rapidement que le style n&#x27;est pas
appliqué. Et c&#x27;est normal. On a dit à webpack comment importer un fichier CSS,
mais on ne lui a pas dit ce qu&#x27;il doit faire avec ce qu&#x27;il a chargé. On a donc
actuellement un fichier CSS chargé en mémoire, mais on n&#x27;en fait rien. Pour
s&#x27;en convaincre, on peut faire la chose suivante :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>// assets/js/app.js</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>import styles from &quot;../css/app.css&quot;;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>console.log(styles);</span></span></div></pre>
<p>Après avoir relancé webpack et affiché notre page, on peut voir un objet
contenant toutes nos règles CSS s&#x27;afficher dans la console du navigateur.</p>
<p>On va donc avoir besoin d&#x27;un autre loader pour dire à webpack ce qu&#x27;il doit
faire avec le CSS qu&#x27;il a chargé : le
<a href="https://www.npmjs.com/package/style-loader"><code>style-loader</code></a>. Ce loader va
prendre le résultat du <code>css-loader</code>, et l&#x27;injecter dans une balise <code>style</code> dans
le <code>head</code> de notre page.</p>
<p>On l&#x27;installe :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev style-loader</span></span></div></pre>
<p>Puis on l&#x27;ajoute aux règles :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  module: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    rules: [</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.js$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;babel-loader&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        include: path.join(__dirname, &quot;assets&quot;, &quot;js&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        options: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>          presets: [&quot;env&quot;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.css$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // il est possible de chaîner plusieurs loaders. Pour ça, on passe un</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // tableau de loaders à la propriété `use`. Les loaders sont appliqués</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        // les uns à la suite des autres, en partant du dernier élément du tableau</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        use: [{ loader: &quot;style-loader&quot; }, { loader: &quot;css-loader&quot; }]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    ]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>Après avoir relancé webpack, le style est cette fois-ci bien appliqué à la
page. Sauf si dans votre CSS vous faites appel à des images ou des fonts. Car
le <code>css-loader</code> va traiter ceux-ci comme des imports de modules, et webpack ne
saura pas comment les charger. On va donc appliquer deux dernières règles à
notre configuration : une pour charger les images, et une pour charger les
fonts. Les deux utiliseront le
<a href="https://www.npmjs.com/package/file-loader"><code>file-loader</code></a> pour simplement
copier les fichiers dans le dossier défini dans <code>output.path</code>.</p>
<p>À nouveau, on l&#x27;installe :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev file-loader</span></span></div></pre>
<p>Et on ajoute deux règles à notre configuration :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  module: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    rules: [</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.js$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;babel-loader&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        include: path.join(__dirname, &quot;assets&quot;, &quot;js&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        options: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>          presets: [&quot;env&quot;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.css$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        use: [{ loader: &quot;style-loader&quot; }, { loader: &quot;css-loader&quot; }]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.(jpg|gif|png|svg)$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;file-loader&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.(ttf|woff|woff2|eot)/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;file-loader&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    ]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>De cette manière, quand webpack croisera un de ces fichiers, il le copiera dans
le dossier <code>output.path</code> et remplacera le chemin d&#x27;origine par celui où il aura
placé le fichier.</p>
<h2 id="le-mode-watch"><a aria-hidden="true" href="#le-mode-watch"><span class="icon icon-link"></span></a>Le mode <code>watch</code></h2>
<p>Relancer webpack à chaque fois qu&#x27;on fait une modification est chronophage. On
aimerait bien que celui-ci se relance automatiquement lorsqu&#x27;on modifie un
fichier. C&#x27;est possible, en utilisant le mode <code>watch</code> de webpack. Celui-ci peut
être activé de 2 manières : via le fichier de configuration, ou via la ligne de
commande.</p>
<p>Pour le fichier de configuration, il suffit d&#x27;ajouter le booléen <code>watch: true</code>
à l&#x27;objet exporté :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const path = require(&quot;path&quot;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span> </span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>module.exports = {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  entry: &quot;./assets/js/app.js&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  output: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    path: path.resolve(__dirname, &quot;web/assets&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    filename: &quot;bundle.js&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  module: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    rules: [</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.js$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;babel-loader&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        include: path.join(__dirname, &quot;assets&quot;, &quot;js&quot;),</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        options: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>          presets: [&quot;env&quot;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.css$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        use: [{ loader: &quot;style-loader&quot; }, { loader: &quot;css-loader&quot; }]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.(jpg|gif|png|svg)$/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;file-loader&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        test: /\.(ttf|woff|woff2|eot)/,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>        loader: &quot;file-loader&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>      }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    ]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  },</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  // webpack se lancera tout le temps en mode watch</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  watch: true</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>};</span></span></div></pre>
<p>Pour la ligne de commande, il faut ajouter le flag <code>-w</code>. On peut donc se faire
un script <code>start</code> qui lance webpack en mode watch :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&quot;scripts&quot;: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  &quot;build&quot;: &quot;webpack&quot;,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  &quot;start&quot;: &quot;webpack -w&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>}</span></span></div></pre>
<p>Ainsi, en lançant <code>npm start</code> en console, webpack crée un bundle, puis attend
qu&#x27;on fasse des modifications pour se relancer automatiquement. De plus, il
utilise un cache qui lui permet de recompiler le bundle très rapidement.</p>
<p>Voilà pour cette introduction à webpack, sa philosophie et son concept de
<em>loaders</em>. Cet outil est capable de faire énormément d&#x27;autres choses. Je vous
conseille de jeter un oeil à la documentation qui est très bien faite. Dans les
prochains articles, on abordera des aspects plus spécifiques comme le <em>code
splitting</em>, les <em>plugins</em>, les <em>sourcemaps</em>, <code>webpack-dev-server</code> et le <em>hot
module replacement</em>. Nous verrons aussi comment webpack peut totalement
remplacer un workflow utilisant gulp (et ça vaudra aussi pour grunt,
évidemment).</p></div><footer style="text-align:center"><a href="https://github.com/drazik/blog/edit/master/content/posts/webpack/index.md" target="_blank">Proposer des modifications</a></footer></article><div><a href="/">Revenir à l&#x27;accueil</a></div></div></div></div><footer><div class="content-wrap"><section class="copy"><p>© <!-- -->2019<!-- --> Cyrille Jesmo Drazik</p></section></div></footer></div></div><script id="PhenomicHydration" type="text/json">{"path=content%2Fposts&id=webpack":{"status":"idle","node":{"filename":"index.md","title":"webpack","headings":[{"level":2,"text":"Qu'est-ce que webpack ?","id":"quest-ce-que-webpack-"},{"level":2,"text":"Ici, tout est module","id":"ici-tout-est-module"},{"level":2,"text":"Installer webpack","id":"installer-webpack"},{"level":2,"text":"Configurer webpack","id":"configurer-webpack"},{"level":2,"text":"Les loaders","id":"les-loaders"},{"level":2,"text":"Importer autre chose que du JS","id":"importer-autre-chose-que-du-js"},{"level":2,"text":"Le mode watch","id":"le-mode-watch"}],"date":"2017-06-28","timeSensitive":true,"body":{"t":"div","c":[{"t":"h2","p":{"id":"quest-ce-que-webpack-"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#quest-ce-que-webpack-"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Qu'est-ce que webpack ?"]},"\n",{"t":"p","c":[{"t":"a","p":{"href":"https://webpack.js.org/"},"c":["webpack"]}," est un ",{"t":"em","c":["module bundler"]},". Il construit le\ngraphe de dépendances d'une application JS afin de les regrouper dans un ou\nplusieurs ",{"t":"em","c":["bundle(s)"]}," qui pourront être exécutés dans un navigateur web. Il\nnous permet donc d'écrire du code modulaire, bien que les navigateurs\nn'implémentent pour la plupart pas encore les modules ES2015. Il fait donc la\nmême chose que ",{"t":"a","p":{"href":"http://browserify.org/"},"c":["browserify"]},". Toutefois, webpack est\ntrès différent de browserify, de par sa philosophie bien particulière."]},"\n",{"t":"h2","p":{"id":"ici-tout-est-module"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#ici-tout-est-module"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Ici, tout est module"]},"\n",{"t":"p","c":["La philosophie de webpack est de traiter n'importe quelle dépendance d'une\napplication comme un module. Ainsi, un fichier JS est un module, un fichier CSS\nest un module, une image est un module... Tous ces modules sont consommables\ndirectement dans le code JS."]},"\n",{"t":"p","c":["On peut donc faire les choses suivantes avec webpack :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// Importer un module JS, classique"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import add from \"./add.js\";"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// Importer un fichier CSS"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import styles from \"./styles.css\";"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// Importer une image"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import logo from \"./logo.png\";"]}]}]}]},"\n",{"t":"p","c":["Webpack est capable de gérer à peu près n'importe quel type de fichier, grâce à\nson systême de ",{"t":"em","c":["loaders"]},". À un type de fichier correspond un (ou plusieurs)\n",{"t":"em","c":["loader(s)"]},", qui a pour but de dire à webpack comment faire pour charger ce\ntype de fichier."]},"\n",{"t":"h2","p":{"id":"installer-webpack"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#installer-webpack"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Installer webpack"]},"\n",{"t":"p","c":["Rien de plus simple, ça se fait évidemment via ",{"t":"code","c":["npm"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev webpack"]}]}]}]},"\n",{"t":"p","c":["Une fois installé, le binaire de webpack est disponible dans\n",{"t":"code","c":["./node_modules/.bin/webpack"]},". Pour éviter d'avoir à taper le chemin complet à\nchaque fois, on peut écrire un script npm dans notre ",{"t":"code","c":["package.json"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["\"scripts\": {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  \"build\": \"webpack\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]}]},"\n",{"t":"p","c":["De cette manière, il suffira de taper ",{"t":"code","c":["npm run build"]},", plutôt que\n",{"t":"code","c":["./node_modules/.bin/webpack"]}," pour lancer webpack."]},"\n",{"t":"p","c":[{"t":"em","c":["Il est aussi possible d'",{"t":"a","p":{"href":"https://webpack.js.org/guides/installation/#global-installation"},"c":["installer webpack en\nglobal"]},", mais\nce n'est pas conseillé."]}]},"\n",{"t":"p","c":[{"t":"em","c":["Si vous voulez en savoir plus à propos des scripts npm, vous pouvez aller voir\nl'article ",{"t":"a","p":{"href":"/articles/ne-plus-installer-gulp-en-dependance-globale/"},"c":["\"ne plus installer gulp en dépendance\nglobale\""]},", qui traite\nde ce sujet."]}]},"\n",{"t":"h2","p":{"id":"configurer-webpack"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#configurer-webpack"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Configurer webpack"]},"\n",{"t":"p","c":["Pour faire fonctionner webpack, on va créer un fichier de configuration, nommé\n",{"t":"code","c":["webpack.config.js"]},". Le minimum requis est un point d'entrée et un point de\nsortie :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  // Notre fichier source"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    // le chemin vers le bundle que webpack va générer"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    // le nom du bundle"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["Avec cette configuration minimale, webpack est capable de gérer nos dépendances\nJS. Donc, si on a la configuration suivante :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// assets/js/add.js"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["export default const add = (a, b) => a + b;"]}]}]}]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// assets/js/app.js"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import add from \"./add.js\";"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["console.log(add(1, 2));"]}]}]}]},"\n",{"t":"p","c":["webpack générera un seul fichier, regroupant ",{"t":"code","c":["add.js"]}," et ",{"t":"code","c":["app.js"]},", et qui une\nfois importé dans une page web, affichera ",{"t":"code","c":["3"]}," dans la console."]},"\n",{"t":"p","c":[{"t":"em","c":["Note : webpack supporte par défaut la syntaxe des modules ES2015. Toutefois,\nc'est le seul aspect de cette syntaxe qu'il transpile directement. Pour le\nreste, il faut utiliser babel."]}]},"\n",{"t":"h2","p":{"id":"les-loaders"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#les-loaders"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Les loaders"]},"\n",{"t":"p","c":["webpack met à disposition une API permettant de lui dire ce qu'il doit faire\nlorsqu'il charge un module : les ",{"t":"em","c":["loaders"]},"."]},"\n",{"t":"p","c":["Par exemple, il est possible de lui dire \"tiens, webpack, lorsque tu charges un\nfichier JS, alors passe le dans babel pour récupérer le code transpilé avant de\ncréer ton bundle\". Pour ça, il faut d'abord installer\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/babel-loader"},"c":[{"t":"code","c":["babel-loader"]}]}," et\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/babel-core"},"c":[{"t":"code","c":["babel-core"]}]},". De plus, nous allons\naussi utiliser le preset\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/babel-preset-env"},"c":[{"t":"code","c":["env"]}]},"."]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev babel-loader babel-core babel-preset-env"]}]}]}]},"\n",{"t":"p","c":["Il faut ensuite modifier notre configuration, pour y ajouter le loader et le\nconfigurer :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  module: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    rules: ["]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // le test se fait sur le nom des fichiers qu'on importe"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // ici, on veut que cette règle s'applique à tous les fichiers dont"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // le nom se termine par \".js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.js$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // on demande à webpack de n'appliquer cette règle qu'aux fichiers qui"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // se trouvent dans ./assets/js. Sinon, il l'appliquerait à tous les"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // fichiers JS, mêmes ceux de node_modules par exemple"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        include: path.join(__dirname, \"assets\", \"js\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // si le test passe, alors on veut appliquer le babel-loader"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"babel-loader\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // on passe des options au loader. Ici, on veut utiliser le preset \"env\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["          presets: [\"env\"]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    ]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["Lorsqu'il tombera sur un nouveau module à importer, webpack le confrontera à\ntoutes les règles que nous avons définies, et celles pour lesquelles le test\nest satisfait lui seront appliquées."]},"\n",{"t":"h2","p":{"id":"importer-autre-chose-que-du-js"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#importer-autre-chose-que-du-js"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Importer autre chose que du JS"]},"\n",{"t":"p","c":["Le graphe de dépendance créé par webpack permet de n'ajouter au bundle que les\nmodules effectivements importés dans notre application. Utiliser ce mécanisme\npour d'autres types de ressources serait très intéressant. Et justement, le\nsystème de loaders va nous permettre d'importer n'importe quel autre type de\nfichier directement dans notre JS, et de le consommer comme étant un module de\nnotre application."]},"\n",{"t":"p","c":["Prenons le cas d'un fichier CSS simple. Nous avons un fichier\n",{"t":"code","c":["assets/css/app.css"]}," contenant l'ensemble du style de notre site. Nous voulons\nque webpack ajoute celui-ci à son graphe de dépendances afin qu'il fasse partie\nde notre bundle final. On l'importe donc dans notre fichier ",{"t":"code","c":["app.js"]}," :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// assets/js/app.js"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import styles from \"../css/app.css\";"]}]}]}]},"\n",{"t":"p","c":["Puis on demande à webpack de créer notre bundle avec ",{"t":"code","c":["npm run build"]},". Et on se\nprend l'erreur suivante :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["ERROR in ./assets/css/app.css"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["Module parse failed: C:\\Users\\ASUS\\workspace\\article-webpack\\assets\\css\\app.css Unexpected token (1:5)"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["You may need an appropriate loader to handle this file type."]}]}]}]},"\n",{"t":"p","c":["Ce que nous explique webpack, c'est qu'il aimerait bien importer notre fichier,\nmais il ne sait pas comment faire. En effet, webpack ne sait s'occuper que des\nfichiers JS out of the box. On va donc se servir d'un loader, non pas pour\ntransformer ce qui est importé, mais pour expliquer à webpack ce qu'il doit\nfaire quand on lui demande de charger un fichier CSS. Ce loader, c'est le\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/css-loader"},"c":[{"t":"code","c":["css-loader"]}]},"."]},"\n",{"t":"p","c":["On commence par l'installer :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev css-loader"]}]}]}]},"\n",{"t":"p","c":["Puis on l'ajoute aux règles de notre configuration :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  module: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    rules: ["]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.js$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"babel-loader\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        include: path.join(__dirname, \"assets\", \"js\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["          presets: [\"env\"]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // pour les fichiers CSS..."]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.css$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // ...utilise le css-loader"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"css-loader\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    ]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["De cette manière, webpack sera capable d'importer un fichier CSS. Toutefois, si\non recharge notre page, on s'apperçoit rapidement que le style n'est pas\nappliqué. Et c'est normal. On a dit à webpack comment importer un fichier CSS,\nmais on ne lui a pas dit ce qu'il doit faire avec ce qu'il a chargé. On a donc\nactuellement un fichier CSS chargé en mémoire, mais on n'en fait rien. Pour\ns'en convaincre, on peut faire la chose suivante :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["// assets/js/app.js"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["import styles from \"../css/app.css\";"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["console.log(styles);"]}]}]}]},"\n",{"t":"p","c":["Après avoir relancé webpack et affiché notre page, on peut voir un objet\ncontenant toutes nos règles CSS s'afficher dans la console du navigateur."]},"\n",{"t":"p","c":["On va donc avoir besoin d'un autre loader pour dire à webpack ce qu'il doit\nfaire avec le CSS qu'il a chargé : le\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/style-loader"},"c":[{"t":"code","c":["style-loader"]}]},". Ce loader va\nprendre le résultat du ",{"t":"code","c":["css-loader"]},", et l'injecter dans une balise ",{"t":"code","c":["style"]}," dans\nle ",{"t":"code","c":["head"]}," de notre page."]},"\n",{"t":"p","c":["On l'installe :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev style-loader"]}]}]}]},"\n",{"t":"p","c":["Puis on l'ajoute aux règles :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  module: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    rules: ["]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.js$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"babel-loader\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        include: path.join(__dirname, \"assets\", \"js\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["          presets: [\"env\"]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.css$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // il est possible de chaîner plusieurs loaders. Pour ça, on passe un"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // tableau de loaders à la propriété `use`. Les loaders sont appliqués"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        // les uns à la suite des autres, en partant du dernier élément du tableau"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        use: [{ loader: \"style-loader\" }, { loader: \"css-loader\" }]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    ]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["Après avoir relancé webpack, le style est cette fois-ci bien appliqué à la\npage. Sauf si dans votre CSS vous faites appel à des images ou des fonts. Car\nle ",{"t":"code","c":["css-loader"]}," va traiter ceux-ci comme des imports de modules, et webpack ne\nsaura pas comment les charger. On va donc appliquer deux dernières règles à\nnotre configuration : une pour charger les images, et une pour charger les\nfonts. Les deux utiliseront le\n",{"t":"a","p":{"href":"https://www.npmjs.com/package/file-loader"},"c":[{"t":"code","c":["file-loader"]}]}," pour simplement\ncopier les fichiers dans le dossier défini dans ",{"t":"code","c":["output.path"]},"."]},"\n",{"t":"p","c":["À nouveau, on l'installe :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev file-loader"]}]}]}]},"\n",{"t":"p","c":["Et on ajoute deux règles à notre configuration :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  module: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    rules: ["]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.js$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"babel-loader\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        include: path.join(__dirname, \"assets\", \"js\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["          presets: [\"env\"]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.css$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        use: [{ loader: \"style-loader\" }, { loader: \"css-loader\" }]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.(jpg|gif|png|svg)$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"file-loader\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.(ttf|woff|woff2|eot)/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"file-loader\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    ]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["De cette manière, quand webpack croisera un de ces fichiers, il le copiera dans\nle dossier ",{"t":"code","c":["output.path"]}," et remplacera le chemin d'origine par celui où il aura\nplacé le fichier."]},"\n",{"t":"h2","p":{"id":"le-mode-watch"},"c":[{"t":"a","p":{"aria-hidden":"true","href":"#le-mode-watch"},"c":[{"t":"span","p":{"class":"icon icon-link"}}]},"Le mode ",{"t":"code","c":["watch"]}]},"\n",{"t":"p","c":["Relancer webpack à chaque fois qu'on fait une modification est chronophage. On\naimerait bien que celui-ci se relance automatiquement lorsqu'on modifie un\nfichier. C'est possible, en utilisant le mode ",{"t":"code","c":["watch"]}," de webpack. Celui-ci peut\nêtre activé de 2 manières : via le fichier de configuration, ou via la ligne de\ncommande."]},"\n",{"t":"p","c":["Pour le fichier de configuration, il suffit d'ajouter le booléen ",{"t":"code","c":["watch: true"]},"\nà l'objet exporté :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["const path = require(\"path\");"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":[" "]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["module.exports = {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  entry: \"./assets/js/app.js\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  output: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    path: path.resolve(__dirname, \"web/assets\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    filename: \"bundle.js\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  module: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    rules: ["]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.js$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"babel-loader\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        include: path.join(__dirname, \"assets\", \"js\"),"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        options: {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["          presets: [\"env\"]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.css$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        use: [{ loader: \"style-loader\" }, { loader: \"css-loader\" }]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.(jpg|gif|png|svg)$/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"file-loader\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        test: /\\.(ttf|woff|woff2|eot)/,"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["        loader: \"file-loader\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["      }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    ]"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  },"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  // webpack se lancera tout le temps en mode watch"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  watch: true"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["};"]}]}]}]},"\n",{"t":"p","c":["Pour la ligne de commande, il faut ajouter le flag ",{"t":"code","c":["-w"]},". On peut donc se faire\nun script ",{"t":"code","c":["start"]}," qui lance webpack en mode watch :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["\"scripts\": {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  \"build\": \"webpack\","]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  \"start\": \"webpack -w\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]}]},"\n",{"t":"p","c":["Ainsi, en lançant ",{"t":"code","c":["npm start"]}," en console, webpack crée un bundle, puis attend\nqu'on fasse des modifications pour se relancer automatiquement. De plus, il\nutilise un cache qui lui permet de recompiler le bundle très rapidement."]},"\n",{"t":"p","c":["Voilà pour cette introduction à webpack, sa philosophie et son concept de\n",{"t":"em","c":["loaders"]},". Cet outil est capable de faire énormément d'autres choses. Je vous\nconseille de jeter un oeil à la documentation qui est très bien faite. Dans les\nprochains articles, on abordera des aspects plus spécifiques comme le ",{"t":"em","c":["code\nsplitting"]},", les ",{"t":"em","c":["plugins"]},", les ",{"t":"em","c":["sourcemaps"]},", ",{"t":"code","c":["webpack-dev-server"]}," et le ",{"t":"em","c":["hot\nmodule replacement"]},". Nous verrons aussi comment webpack peut totalement\nremplacer un workflow utilisant gulp (et ça vaudra aussi pour grunt,\névidemment)."]}]}}}}</script><script src="/phenomic/phenomic.main.29349b76.js" async=""></script></body></html>