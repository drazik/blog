<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/phenomic/phenomic.main.31cbc6e9.css"/></head><body><div id="PhenomicRoot"><div data-reactroot=""><header class="header"><div class="content-wrap"><div class="logo"><h1><a href="/">Jesmo Drazik Blog</a></h1><p class="description">Développeur front-end @ Cozy Cloud</p><div class="find-me"><a href="https://twitter.com/JesmoDrazik">Twitter</a><a href="https://github.com/drazik">GitHub</a></div></div></div></header><div id="content"><div class="content-wrap"><div><article class="article"><h1 style="text-align:center">Utiliser webpack-bundle-analyzer avec create-react-app</h1><div><p>La méthode préconisée par la documentation de create-react-app pour analyser la
taille de son bundle est d&#x27;utiliser
<a href="https://facebook.github.io/create-react-app/docs/analyzing-the-bundle-size">source-map-explorer</a>.
Après avoir essayé cet outil, il s&#x27;avère qu&#x27;il est tout de même moins agréable
à utiliser que
<a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a>.
Mais celui-ci s&#x27;utilise comme un plugin webpack, il faut donc utiliser la
fonction
<a href="https://facebook.github.io/create-react-app/docs/available-scripts#npm-run-eject"><code>eject</code></a>
de create-react-app pour pouvoir l&#x27;utiliser. Toutefois, ejecter ou forker
react-scripts pour simplement ajouter ce plugin serait dommage... Heureusement,
il est possible de l&#x27;utiliser sans ejecter, bien que ça ne soit pas vraiment
documenté.</p>
<p>La première étape est évidemment d&#x27;installer webpack-bundle-analyzer :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm install --save-dev webpack-bundle-analyzer</span></span></div></pre>
<p>Ensuite, on va modifier le script <code>build</code> pour que celui-ci génère un fichier
de statistiques qui pourra ensuite être consommé par webpack-bundle-analyzer :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  &quot;scripts&quot;: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    &quot;build&quot;: &quot;react-scripts build --stats&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>}</span></span></div></pre>
<p>L&#x27;option <code>--stats</code> aura pour effet de générer le fichier <code>bundle-stats.json</code>
dans le dossier <code>build</code> lors de la génération du bundle. Cette option n&#x27;est pas
documentée, mais on peut voir son effet dans les sources du script build :
<a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/scripts/build.js#L65">ici</a>
et
<a href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/scripts/build.js#L191-L196">là</a>.</p>
<p>Il ne nous reste plus qu&#x27;à lancer webpack-bundle-analyzer en lui passant ce
fichier en entrée :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  &quot;scripts&quot;: {</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>    &quot;analyze&quot;: &quot;webpack-bundle-analyzer build/bundle-stats.json&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>  }</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>}</span></span></div></pre>
<p>Et lancer ce script <code>analyze</code>, après avoir fait un build :</p>
<pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm run build &amp;&amp; npm run analyze</span></span></div></pre>
<p>Et voilà :)</p></div><footer style="text-align:center"><a href="https://github.com/drazik/blog/edit/master/content/posts/create-react-app-webpack-bundle-analyzer/index.md" target="_blank">Proposer des modifications</a></footer></article><div><a href="/">Revenir à l&#x27;accueil</a></div></div></div></div><footer><div class="content-wrap"><section class="copy"><p>© <!-- -->2019<!-- --> Cyrille Jesmo Drazik</p></section></div></footer></div></div><script id="PhenomicHydration" type="text/json">{"path=content%2Fposts&id=create-react-app-webpack-bundle-analyzer":{"status":"idle","node":{"filename":"index.md","title":"Utiliser webpack-bundle-analyzer avec create-react-app","date":"2018-12-24","timeSensitive":true,"body":{"t":"div","c":[{"t":"p","c":["La méthode préconisée par la documentation de create-react-app pour analyser la\ntaille de son bundle est d'utiliser\n",{"t":"a","p":{"href":"https://facebook.github.io/create-react-app/docs/analyzing-the-bundle-size"},"c":["source-map-explorer"]},".\nAprès avoir essayé cet outil, il s'avère qu'il est tout de même moins agréable\nà utiliser que\n",{"t":"a","p":{"href":"https://github.com/webpack-contrib/webpack-bundle-analyzer"},"c":["webpack-bundle-analyzer"]},".\nMais celui-ci s'utilise comme un plugin webpack, il faut donc utiliser la\nfonction\n",{"t":"a","p":{"href":"https://facebook.github.io/create-react-app/docs/available-scripts#npm-run-eject"},"c":[{"t":"code","c":["eject"]}]},"\nde create-react-app pour pouvoir l'utiliser. Toutefois, ejecter ou forker\nreact-scripts pour simplement ajouter ce plugin serait dommage... Heureusement,\nil est possible de l'utiliser sans ejecter, bien que ça ne soit pas vraiment\ndocumenté."]},"\n",{"t":"p","c":["La première étape est évidemment d'installer webpack-bundle-analyzer :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm install --save-dev webpack-bundle-analyzer"]}]}]}]},"\n",{"t":"p","c":["Ensuite, on va modifier le script ",{"t":"code","c":["build"]}," pour que celui-ci génère un fichier\nde statistiques qui pourra ensuite être consommé par webpack-bundle-analyzer :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["{"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  \"scripts\": {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    \"build\": \"react-scripts build --stats\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]}]},"\n",{"t":"p","c":["L'option ",{"t":"code","c":["--stats"]}," aura pour effet de générer le fichier ",{"t":"code","c":["bundle-stats.json"]},"\ndans le dossier ",{"t":"code","c":["build"]}," lors de la génération du bundle. Cette option n'est pas\ndocumentée, mais on peut voir son effet dans les sources du script build :\n",{"t":"a","p":{"href":"https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/scripts/build.js#L65"},"c":["ici"]},"\net\n",{"t":"a","p":{"href":"https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/scripts/build.js#L191-L196"},"c":["là"]},"."]},"\n",{"t":"p","c":["Il ne nous reste plus qu'à lancer webpack-bundle-analyzer en lui passant ce\nfichier en entrée :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["{"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  \"scripts\": {"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["    \"analyze\": \"webpack-bundle-analyzer build/bundle-stats.json\""]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["  }"]}]}]},{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["}"]}]}]}]},"\n",{"t":"p","c":["Et lancer ce script ",{"t":"code","c":["analyze"]},", après avoir fait un build :"]},"\n",{"t":"pre","p":{"class":"editor editor-colors"},"c":[{"t":"div","p":{"class":"line"},"c":[{"t":"span","p":{"class":"syntax--text syntax--plain syntax--null-grammar"},"c":[{"t":"span","c":["npm run build && npm run analyze"]}]}]}]},"\n",{"t":"p","c":["Et voilà :)"]}]}}}}</script><script src="/phenomic/phenomic.main.31cbc6e9.js" async=""></script></body></html>